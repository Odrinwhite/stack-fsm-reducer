"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const minimatch = require("minimatch");
exports.path = (stack) => {
    return stack.map(s => s.stateId).join('/');
};
exports.head = (stack) => {
    return stack.length ? stack[stack.length - 1] : undefined;
};
exports.push = (stack, ...state) => {
    return [...stack, ...state];
};
exports.pop = (stack) => {
    return stack.slice(0, stack.length - 1);
};
exports.splitHead = (stack) => {
    if (stack.length > 0) {
        return [stack.slice(0, stack.length - 1), stack[stack.length - 1]];
    }
    else {
        return [[], undefined];
    }
};
exports.splitLastTwo = (stack) => {
    if (stack.length >= 2) {
        return [stack.slice(0, stack.length - 2), stack[stack.length - 2], stack[stack.length - 1]];
    }
    else if (stack.length === 1) {
        return [[], undefined, stack[0]];
    }
    else {
        return [[], undefined, undefined];
    }
};
exports.match = (path, query) => {
    return minimatch(path, query);
};
exports.createStackReducer = (reducersMap) => (state = [], action) => {
    let prevState = undefined;
    let iterations = 0;
    while (true) {
        if (prevState === state)
            return state;
        ++iterations;
        prevState = state;
        state = Object.keys(reducersMap).reduce((acc, query) => exports.match(exports.path(state), query) ? reducersMap[query](acc, action) : acc, state);
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhY2stcmVkdWNlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zdGFjay1yZWR1Y2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsdUNBQXNDO0FBWXpCLFFBQUEsSUFBSSxHQUFHLENBQXVDLEtBQWtCO0lBQzNFLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0FBQzVDLENBQUMsQ0FBQTtBQUVZLFFBQUEsSUFBSSxHQUFHLENBQXVDLEtBQWtCO0lBQzNFLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxHQUFHLFNBQVMsQ0FBQTtBQUMzRCxDQUFDLENBQUE7QUFFWSxRQUFBLElBQUksR0FBRyxDQUF1QyxLQUFrQixFQUFFLEdBQUcsS0FBVTtJQUMxRixNQUFNLENBQUMsQ0FBQyxHQUFHLEtBQUssRUFBRSxHQUFHLEtBQUssQ0FBQyxDQUFBO0FBQzdCLENBQUMsQ0FBQTtBQUVZLFFBQUEsR0FBRyxHQUFHLENBQXVDLEtBQWtCO0lBQzFFLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFBO0FBQ3pDLENBQUMsQ0FBQTtBQUVZLFFBQUEsU0FBUyxHQUFHLENBQXVDLEtBQWtCO0lBQ2hGLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNyQixNQUFNLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUE7SUFDcEUsQ0FBQztJQUFDLElBQUksQ0FBQyxDQUFDO1FBQ04sTUFBTSxDQUFDLENBQUMsRUFBRSxFQUFFLFNBQVMsQ0FBQyxDQUFBO0lBQ3hCLENBQUM7QUFDSCxDQUFDLENBQUE7QUFFWSxRQUFBLFlBQVksR0FBRyxDQUF1QyxLQUFrQjtJQUNuRixFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsTUFBTSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEIsTUFBTSxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQzdGLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzlCLE1BQU0sQ0FBQyxDQUFDLEVBQUUsRUFBRSxTQUFTLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7SUFDbEMsQ0FBQztJQUFDLElBQUksQ0FBQyxDQUFDO1FBQ04sTUFBTSxDQUFDLENBQUMsRUFBRSxFQUFFLFNBQVMsRUFBRSxTQUFTLENBQUMsQ0FBQTtJQUNuQyxDQUFDO0FBQ0gsQ0FBQyxDQUFBO0FBRVksUUFBQSxLQUFLLEdBQUcsQ0FBQyxJQUFZLEVBQUUsS0FBYTtJQUMvQyxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQTtBQUMvQixDQUFDLENBQUE7QUFRWSxRQUFBLGtCQUFrQixHQUFHLENBQXlELFdBQWlDLEtBQTRCLENBQUMsUUFBcUIsRUFBRSxFQUFFLE1BQVM7SUFDekwsSUFBSSxTQUFTLEdBQUcsU0FBUyxDQUFBO0lBQ3pCLElBQUksVUFBVSxHQUFHLENBQUMsQ0FBQTtJQUNsQixPQUFPLElBQUksRUFBRSxDQUFDO1FBQ1osRUFBRSxDQUFDLENBQUMsU0FBUyxLQUFLLEtBQUssQ0FBQztZQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUE7UUFDckMsRUFBRSxVQUFVLENBQUE7UUFDWixTQUFTLEdBQUcsS0FBSyxDQUFBO1FBQ2pCLEtBQUssR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxLQUFLLEtBQUssYUFBSyxDQUFDLFlBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxLQUFLLENBQUMsR0FBRyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxHQUFHLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQTtJQUNuSSxDQUFDO0FBQ0gsQ0FBQyxDQUFBIn0=